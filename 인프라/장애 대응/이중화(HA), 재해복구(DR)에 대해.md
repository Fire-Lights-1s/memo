# Fail over란
- fail over는 장애 대비 기능을 의미
- 장애 극복 기능은 컴퓨터 서버, 시스템, 네트워크 등에서 이상이 생겼을 때 미리 준비 했던 다른 시스템으로 자동으로 전환해서 무정지 시스템을 운영하는 것
## 활용
- 평상시 A 장비를 사용하다가, A 장비에 장애가 발생하면 준비했던 B장비를 사용
- 운영되고 있는 시스템은 액티브, 같은 세팅으로 구성된 대기하는 시스템은 패시브라고 한다
- 운영 중에 액티브 시스템이 멈추거나, 장애가 발생하며느 패시브 시스템이 액티브 상태로 변경되면서, 서비스를 이어서 운영
- **높은 가용성**(서비스를 정상적으로 사용 가능한 정도를 의미)을 요구할 때 구성한다.
- 장애 발생 시 손해와 운영 중인 데이터의 경중을 따져서 **중요한 것부터 우선적으로 준비**한다.
- 웹 서버, 네트워크 장비, DB 등 다양한 영역에 대비한다. 하드웨어적인 장애 뿐만 아니라 소프트웨어를 포함한 서비스가 운영되지 않은 모든 장애를 포함한다.  
    운영되고 있는 시스템은 "**액티브(Active), 프라이머리(Primary),마스터(Master)**"  
    대기하고 있는 시스템은 "**패시브(Passive), 스탠바이(Standby), 세컨더리(Secondary), 슬레이브(Slave)**"

# 이중화(High Availability)

> - 메인서버(액티브)와 백업서버(스탠바이)를 연결하고 장애 발생 시 백업 서버로 실시간 업무 이관(페일오버)해 서비스 중단을 막는다.
> - 이중화 구성에는 다중화된 요소를 모두 이용할 수 있는 Active-Active와 다중화된 요소 중 한쪽은 사용할 수 없는 Active-Standby 두 종류가 있다.

### 서버 이중화의 목적

> - 서버 이중화는 두 가지의 큰 목적을 가지고 있다
>     - **Failover(장애 조치)** - 장애 혹은 재해 발생시 빠른 서비스 재개를 하기 위함
>         - 서비스 일시 중단(downtime)이 발생 하더라도 재빠르게 대응하기 위함
>         - 1차적으로 자동 Fialover 할 수 있도록 설계
>     - **LoadBalance(부하 분산)** - 원활한 서비스의 성능을 보장하기 위함
>         - 하나의 기기가 일정량 이상의 사용자 트랜잭션을 처리하는 경우 응답 시간이 느려질 가능성이 있다.
>         - 사용 트랜잭션의 패턴과 사용량 등을 분석하여 부하를 분산하여 효율적인 업무 처리 가능
>         - 로드밸런싱을 구현하고자 하는 지점에 따라 미들웨어, 네트워크, OS등 다양한 지점에서 구현 가능

## 구성  요소
#### Active-Active -주로 부하 분산 등의 목적, 서비스 단위를 나누어서 분산
- **다중화 장비 두 대가 모두 활성화 되어 동작**하는 구성
- 많은 비용이 필요하지만 높은 수준의 안정성을 확보할 수 있다. 사용자가 많고 안정성을 우선시 한다면 사용하는 방식이다.

단점
- Active-Standby에 비해 처리률이 높지만, 설정 및 구성이 복잡해진다
- 한 대에 장애가 생겼을 경우, 두 대의 처리량을 한 대가 처리해야 하기 때문에 리소스가 높아져 리소스에 대한 계획도 필요하다

#### Active-Standby - 즉각적인 Failover를 위해 주로 구성
- **한 대는 평상 시 운영하는 서버이고, 그와 비슷한 스펙의 서버를 예비로 준비**한다
- 예비서버는 OS가 설치된 형태로 언제라도 부팅하면 바로 사용할 수 있는 상태, 장애 시 서비스를 이전하여 운영하는 방법
- 클러스터 하트비트 등으로 시스템의 상태를 주기적으로 체크하고 특이사랑 발생시 수동으로 전환하거나, 크리티컬한 장애 발생 시 자동으로 서비스를 전환
- 즉각적인 failover를 위해 주로 구성
- 장애 발생시 Standby는 Active로 변경된다. Failover 되는 시간은 서비스가 불가능하다.
- 시스템 장애 시간이 길고 안정성이 적은 방식
 
>Active-Standby는 Standby 방식에 따라 아래와 같이 세 종류로 나뉜다
>- Hot Standby  - Standby 측은 가동 후 즉시 이용가능한 구성
>- Warm Standby  -	Standby 측은 가동 후 이용가능하게 하기 위해서 나름대로의 준비가 필요한 구성
>- Cold Standby  -	Standby 측을 정지시켜 두는 구성, 필요시 직접 켜서 구성

### 다중화 구조에서 데이터 정합성을 얻는 방법
- 다중화한 경우 주의점은 **같은 데이터가 여러 개 존재한다는 것**
- 어떤 데이터가 올바른 것인지 또는 어떤 데이터가 최신 데이터인지 제대로 관리
- 여러 개의 데이터가 정확하게 일치하고 있는 상태를 유지해야 한다
- 일반적 **스토리지 공유 방식 Shared Disk** 과 스토리지 **비공유 방식 Shared Nothing** 이 있다

#### Shared Disk
- **하나의 스토리지를 공유**하고, 대개는 전용 스토리지 기기를 이용하는 방식이다.
- Shared Disk 방식은 스토리지를 공유하기 때문에 정합성에 대해 특별히 문제는 없다
- Shared Disk 자체를 다중화해야 하기 때문에 **비용 측면에서 부담**이 생긴다.(대체로 Shared Disk 기능이 있는 스토리지 기기는 값비싸다. )

#### Shared Nothing
- **스토리지 간 통신을 하여 데이터 정합성을 확보**하는 방식이다
- 이 통신을 **리플리케이션**이라고 하고, 리플리케이션의 데이터 송신 측을 Master, 데이터 수신 측을 Slave라고 한다
- Multi-Master라고 하여 Master와 Slave 역할을 모두 갖는 방식도 있지만 문제가 많이 발생하여 잘 사용되지 않는다
- 리플리케이션에도 동기, 비동기식 리플리케이션이 있다
- **동기식 리플리케이션**은 오버헤드가 커 동기 처리에 따라 성능 저하의 정도가 크지만 데이터 정합성을 확보하기 좋다
- **비동기식 레플리케이션**은 데이터 손실이 발생할 수 있지만 성능 저하의 정도가 작은 방식이다

# DR 센터(Disaster Recovery - 재해 복구)
- **재해의 영향을 받지 않는 외부 위치에서 데이터 및 컴퓨터 처리 작업을 복제**
- DR 센터는 서비스 운영하는 전산센터 혹 서비스에 재해가 발생하는 경우 **즉각적인 서비스 복구를 위한 Backup 플랜 인프라 구성**을 의미
- DR 센터 및 시스템은 운영 선테 시스템에 대한 Standby(혹은 Active) 시스템을 원격지에 구성하여 장애시 신속하게 서비스를 재개할 수 있도록 구성한 것을 의미한다
- **금융 IT나 금융 시스템은 DR센터 적극 구성하고 운영**하고 있다


>※ 복구 수준별 구분
>- 미러 사이트(Mirror Site)(1등급)  - **실시간 미러링으로 주 센터와 백업 센터 데이터를 동기화**하여 백업하는 방식(주센터 및 백업 센터간 네트워크도 이중화 구성 포함)
  - 글로벌 빅테크가 활용하며 국내에서는 1금융 전산센터
>- 핫 사이트 (Hot site)(2등급) - **대기(stand) 상태로 실시간 미러링**을 통해 데이터센터와 같은 수준의 데이터를 유지하는 방식
  - 재해 발생시 복구 시간 4시간 이내
>- 웜 사이트 (Warm Site)(3등급)- 주기적으로 중요성이 높은 데이터를 백업하여 로컬이나 원격지에 해당 백업 데이터를 보관 및 소산 하는 방식 (핫사이트에 비해 구축 비용 저렴)
  - 수일에서 수주 소요
>- 콜드 사이트(Cold Site)(4등급) - 단순 데이터를 저장하기 위한 방안으로 미러사이트나 핫사이트를 보완하기 위해 주로 쓰인다.
  - 수주에서 수개월 소요


> 참고 
> https://velog.io/@yange/%EC%9D%B4%EC%A4%91%ED%99%94%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC