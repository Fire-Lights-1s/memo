# 이미지 레이어
- 도커 이미지는 저장소를 효율적으로 사용하기 위해서 레이어드 파일 시스템으로 구성되어있다.
- 레이어는 하나의 층을 의미한다.
- 컨테이너를 실행하기 위한 세이브 포인트 역할

![이미지 레이어](<./images/이미지_레이어.png>)
- nginx라는 하나의 이미지를 다운받는 과정에서 pull이 여러 단계에 걸쳐서 실행된다.
- 실행된 한 줄이 하나의 레이어를 의미한다.
- 각각의 이미지는 이미지의 일부분을 나타낸다.


레이어드 파일 시스템의 장점
- 재사용이 유리한 구조
- 공간을 효율적으로 사용할 수 있다.
- 이미지를 저장하고 전송 할 때 스토리지와 네트워크 사용량을 절약할 수 있다.

![이미지 레이어 예시](<./images/이미지_레이어_예시.png>)

## 이미지 레이어와 컨테이너 레이어
이미지 레이어
- 컨테이너를 실행하기 위한 세이브 포인트 역할

컨테이너 레이어
- 이미지를 컨테이너로 실행한 다음에 프로세스가 변경하는 내용을 기록하는 레이어

![이미지 레이어와 컨테이너 레이어](<./images/이미지_레이어_컨테이너_레이어.png>)

## 정리
- Layering : 각 레이어는 이전 레이어 위에 쌍이며, 여러 이미지 간에 공유될 수 있습니다. 레이어 방식은 **중복 데이터를 최소화**하고, **빌드 속도**를 높이며, **저장소를 효율적으로 사용**할 수 있게 한다.
- Copy-on-Write(CoW) 전략 : 다음 레이어에서 이전 레이어의 특정 파일을 수정 할 때, **해당 파일의 복사본을 만들어서 변경 사항을 적용**합니다. 이렇게 함으로써 원래 레이어는 수정되지 않고 그대로 유지된다.
- Immutable Layers (불변 레이어) : 이미지의 각 레이어는 불변으로, 한 번 생성되면 변경되지 않는다. 이렇게 함으로써 **이미지의 일관성을 유지**하고,여러컨테이너에서안전하게공유할수있다. 
- Caching (캐싱) : 레이어를 캐시하여, 이미 **빌드된레이어를 재사용**할 수 있습니다. 이는 이미지 빌드 시간을 크게 줄여주며, 같은 레이어를 사용하는 여러 이미지에서효율적으로 작동한다.